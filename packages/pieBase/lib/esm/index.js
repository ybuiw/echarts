import _objectSpread from "@babel/runtime/helpers/objectSpread2";
import _slicedToArray from "@babel/runtime/helpers/slicedToArray";
import React, { useEffect, useRef, useState } from 'react';
import * as echarts from 'echarts/core';
import { TooltipComponent, LegendComponent } from 'echarts/components';
import { PieChart } from 'echarts/charts';
import { CanvasRenderer } from 'echarts/renderers';
echarts.use([TooltipComponent, LegendComponent, PieChart, CanvasRenderer]);

var EChartsPie = function EChartsPie(props) {
  var _props$width = props.width,
      width = _props$width === void 0 ? '100%' : _props$width,
      _props$height = props.height,
      height = _props$height === void 0 ? '100%' : _props$height,
      _props$colors = props.colors,
      colors = _props$colors === void 0 ? ['#5470c6', '#91cc75', '#fac858', '#ee6666', '#73c0de', '#3ba272', '#fc8452', '#9a60b4', '#ea7ccc'] : _props$colors,
      _props$label = props.label,
      label = _props$label === void 0 ? {} : _props$label,
      _props$series = props.series,
      series = _props$series === void 0 ? {} : _props$series,
      _props$legend = props.legend,
      legend = _props$legend === void 0 ? {} : _props$legend,
      _props$data = props.data,
      data = _props$data === void 0 ? [] : _props$data,
      _props$isSwitch = props.isSwitch,
      isSwitch = _props$isSwitch === void 0 ? false : _props$isSwitch,
      _props$switchTime = props.switchTime,
      switchTime = _props$switchTime === void 0 ? 2000 : _props$switchTime,
      onClick = props.onClick;
  var chartRef = useRef(null);

  var _useState = useState(null),
      _useState2 = _slicedToArray(_useState, 2),
      myChart = _useState2[0],
      setMyChart = _useState2[1];

  var _useState3 = useState(false),
      _useState4 = _slicedToArray(_useState3, 1),
      isHigh = _useState4[0];

  var _useState5 = useState(0),
      _useState6 = _slicedToArray(_useState5, 2),
      highIndex = _useState6[0],
      setHighIndex = _useState6[1];

  useEffect(function () {
    var _myChart = echarts.init(chartRef.current);

    setMyChart(_myChart);
    window.addEventListener("resize", _myChart.resize, false);
    window.addEventListener('load', _myChart.resize, false);

    _myChart.off('click');

    _myChart.on('click', function (v) {
      onClick === null || onClick === void 0 ? void 0 : onClick(v.data);
      console.log(v.data);
    });

    return function () {
      window.removeEventListener('resize', _myChart.resize, false);
      window.removeEventListener('load', _myChart.resize, false);

      _myChart.dispose();
    };
  }, []);
  useEffect(function () {
    if (myChart) {
      myChart.clear();
      var _names = [];
      data.length > 0 && data.map(function (item) {
        _names.push(item.name);
      });

      var _legend = _objectSpread(_objectSpread({}, {
        bottom: '5%',
        left: 'center',
        icon: 'circle',
        show: true
      }), legend);

      myChart.setOption({
        tooltip: {
          trigger: 'item',
          transitionDuration: 0
        },
        legend: _legend,
        color: colors,
        series: [{
          data: data,
          type: 'pie',
          radius: series.radius ? series.radius : '70%',
          center: series.center ? series.center : ['50%', '50%'],
          label: {
            show: label.show,
            alignTo: label.edgeDistance ? 'edge' : 'none',
            fontSize: label.fontSize,
            edgeDistance: label.edgeDistance,
            minMargin: label.minMargin ? label.minMargin : 10,
            color: label.color,
            lineHeight: label.lineHeight ? label.lineHeight : 20,
            formatter: label.formatter ? label.formatter : false
          },
          labelLine: {
            length: label.length ? label.length : 10,
            length2: label.length2 ? label.length2 : 20
          }
        }]
      }, true);
    }
  }, [myChart, data]);
  useEffect(function () {
    var faultByHourTime;

    if (myChart && isSwitch && !isHigh && data.length > 0) {
      faultByHourTime = setInterval(function () {
        setHighIndex(function (n) {
          myChart.dispatchAction({
            type: 'showTip',
            seriesIndex: 0,
            dataIndex: n
          });

          if (n >= data.length - 1) {
            return 0;
          } else {
            return n + 1;
          }
        });
      }, switchTime);
    }

    return function () {
      clearInterval(faultByHourTime);
    };
  }, [myChart, isSwitch, isHigh, data]);
  return /*#__PURE__*/React.createElement("div", {
    ref: chartRef,
    style: {
      'width': width,
      'height': height
    }
  });
};

export default EChartsPie;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9pbmRleC50c3giXSwibmFtZXMiOlsiUmVhY3QiLCJ1c2VFZmZlY3QiLCJ1c2VSZWYiLCJ1c2VTdGF0ZSIsImVjaGFydHMiLCJUb29sdGlwQ29tcG9uZW50IiwiTGVnZW5kQ29tcG9uZW50IiwiUGllQ2hhcnQiLCJDYW52YXNSZW5kZXJlciIsInVzZSIsIkVDaGFydHNQaWUiLCJwcm9wcyIsIndpZHRoIiwiaGVpZ2h0IiwiY29sb3JzIiwibGFiZWwiLCJzZXJpZXMiLCJsZWdlbmQiLCJkYXRhIiwiaXNTd2l0Y2giLCJzd2l0Y2hUaW1lIiwib25DbGljayIsImNoYXJ0UmVmIiwibXlDaGFydCIsInNldE15Q2hhcnQiLCJpc0hpZ2giLCJoaWdoSW5kZXgiLCJzZXRIaWdoSW5kZXgiLCJfbXlDaGFydCIsImluaXQiLCJjdXJyZW50Iiwid2luZG93IiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlc2l6ZSIsIm9mZiIsIm9uIiwidiIsImNvbnNvbGUiLCJsb2ciLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZGlzcG9zZSIsImNsZWFyIiwiX25hbWVzIiwibGVuZ3RoIiwibWFwIiwiaXRlbSIsInB1c2giLCJuYW1lIiwiX2xlZ2VuZCIsImJvdHRvbSIsImxlZnQiLCJpY29uIiwic2hvdyIsInNldE9wdGlvbiIsInRvb2x0aXAiLCJ0cmlnZ2VyIiwidHJhbnNpdGlvbkR1cmF0aW9uIiwiY29sb3IiLCJ0eXBlIiwicmFkaXVzIiwiY2VudGVyIiwiYWxpZ25UbyIsImVkZ2VEaXN0YW5jZSIsImZvbnRTaXplIiwibWluTWFyZ2luIiwibGluZUhlaWdodCIsImZvcm1hdHRlciIsImxhYmVsTGluZSIsImxlbmd0aDIiLCJmYXVsdEJ5SG91clRpbWUiLCJzZXRJbnRlcnZhbCIsIm4iLCJkaXNwYXRjaEFjdGlvbiIsInNlcmllc0luZGV4IiwiZGF0YUluZGV4IiwiY2xlYXJJbnRlcnZhbCJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxPQUFPQSxLQUFQLElBQWdCQyxTQUFoQixFQUEyQkMsTUFBM0IsRUFBbUNDLFFBQW5DLFFBQW1ELE9BQW5EO0FBRUEsT0FBTyxLQUFLQyxPQUFaLE1BQXlCLGNBQXpCO0FBQ0EsU0FBU0MsZ0JBQVQsRUFBMkJDLGVBQTNCLFFBQTBFLG9CQUExRTtBQUNBLFNBQVNDLFFBQVQsUUFBeUIsZ0JBQXpCO0FBQ0EsU0FBU0MsY0FBVCxRQUErQixtQkFBL0I7QUFFQUosT0FBTyxDQUFDSyxHQUFSLENBQ0UsQ0FBQ0osZ0JBQUQsRUFBbUJDLGVBQW5CLEVBQW9DQyxRQUFwQyxFQUE4Q0MsY0FBOUMsQ0FERjs7QUFvREEsSUFBTUUsVUFBVSxHQUFHLFNBQWJBLFVBQWEsQ0FBQ0MsS0FBRCxFQUF5QjtBQUMxQyxxQkFXSUEsS0FYSixDQUNFQyxLQURGO0FBQUEsTUFDRUEsS0FERiw2QkFDVSxNQURWO0FBQUEsc0JBV0lELEtBWEosQ0FFRUUsTUFGRjtBQUFBLE1BRUVBLE1BRkYsOEJBRVcsTUFGWDtBQUFBLHNCQVdJRixLQVhKLENBR0VHLE1BSEY7QUFBQSxNQUdFQSxNQUhGLDhCQUdXLENBQUMsU0FBRCxFQUFZLFNBQVosRUFBdUIsU0FBdkIsRUFBa0MsU0FBbEMsRUFBNkMsU0FBN0MsRUFBd0QsU0FBeEQsRUFBbUUsU0FBbkUsRUFBOEUsU0FBOUUsRUFBeUYsU0FBekYsQ0FIWDtBQUFBLHFCQVdJSCxLQVhKLENBSUVJLEtBSkY7QUFBQSxNQUlFQSxLQUpGLDZCQUlVLEVBSlY7QUFBQSxzQkFXSUosS0FYSixDQUtFSyxNQUxGO0FBQUEsTUFLRUEsTUFMRiw4QkFLVyxFQUxYO0FBQUEsc0JBV0lMLEtBWEosQ0FNRU0sTUFORjtBQUFBLE1BTUVBLE1BTkYsOEJBTVcsRUFOWDtBQUFBLG9CQVdJTixLQVhKLENBT0VPLElBUEY7QUFBQSxNQU9FQSxJQVBGLDRCQU9TLEVBUFQ7QUFBQSx3QkFXSVAsS0FYSixDQVFFUSxRQVJGO0FBQUEsTUFRRUEsUUFSRixnQ0FRYSxLQVJiO0FBQUEsMEJBV0lSLEtBWEosQ0FTRVMsVUFURjtBQUFBLE1BU0VBLFVBVEYsa0NBU2UsSUFUZjtBQUFBLE1BVUVDLE9BVkYsR0FXSVYsS0FYSixDQVVFVSxPQVZGO0FBYUEsTUFBTUMsUUFBUSxHQUFHcEIsTUFBTSxDQUFNLElBQU4sQ0FBdkI7O0FBQ0Esa0JBQThCQyxRQUFRLENBQU0sSUFBTixDQUF0QztBQUFBO0FBQUEsTUFBT29CLE9BQVA7QUFBQSxNQUFnQkMsVUFBaEI7O0FBQ0EsbUJBQWlCckIsUUFBUSxDQUFVLEtBQVYsQ0FBekI7QUFBQTtBQUFBLE1BQU9zQixNQUFQOztBQUNBLG1CQUFrQ3RCLFFBQVEsQ0FBUyxDQUFULENBQTFDO0FBQUE7QUFBQSxNQUFPdUIsU0FBUDtBQUFBLE1BQWtCQyxZQUFsQjs7QUFHQTFCLEVBQUFBLFNBQVMsQ0FBQyxZQUFNO0FBQ2QsUUFBSTJCLFFBQWEsR0FBR3hCLE9BQU8sQ0FBQ3lCLElBQVIsQ0FBYVAsUUFBUSxDQUFDUSxPQUF0QixDQUFwQjs7QUFDQU4sSUFBQUEsVUFBVSxDQUFDSSxRQUFELENBQVY7QUFFQUcsSUFBQUEsTUFBTSxDQUFDQyxnQkFBUCxDQUF3QixRQUF4QixFQUFrQ0osUUFBUSxDQUFDSyxNQUEzQyxFQUFtRCxLQUFuRDtBQUNBRixJQUFBQSxNQUFNLENBQUNDLGdCQUFQLENBQXdCLE1BQXhCLEVBQWdDSixRQUFRLENBQUNLLE1BQXpDLEVBQWlELEtBQWpEOztBQUNBTCxJQUFBQSxRQUFRLENBQUNNLEdBQVQsQ0FBYSxPQUFiOztBQUNBTixJQUFBQSxRQUFRLENBQUNPLEVBQVQsQ0FBWSxPQUFaLEVBQXFCLFVBQUNDLENBQUQsRUFBWTtBQUMvQmYsTUFBQUEsT0FBTyxTQUFQLElBQUFBLE9BQU8sV0FBUCxZQUFBQSxPQUFPLENBQUdlLENBQUMsQ0FBQ2xCLElBQUwsQ0FBUDtBQUNBbUIsTUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVlGLENBQUMsQ0FBQ2xCLElBQWQ7QUFDRCxLQUhEOztBQUlBLFdBQU8sWUFBTTtBQUNYYSxNQUFBQSxNQUFNLENBQUNRLG1CQUFQLENBQTJCLFFBQTNCLEVBQXFDWCxRQUFRLENBQUNLLE1BQTlDLEVBQXNELEtBQXREO0FBQ0FGLE1BQUFBLE1BQU0sQ0FBQ1EsbUJBQVAsQ0FBMkIsTUFBM0IsRUFBbUNYLFFBQVEsQ0FBQ0ssTUFBNUMsRUFBb0QsS0FBcEQ7O0FBQ0FMLE1BQUFBLFFBQVEsQ0FBQ1ksT0FBVDtBQUNELEtBSkQ7QUFLRCxHQWhCUSxFQWdCTixFQWhCTSxDQUFUO0FBa0JBdkMsRUFBQUEsU0FBUyxDQUFDLFlBQU07QUFDZCxRQUFJc0IsT0FBSixFQUFhO0FBQ1hBLE1BQUFBLE9BQU8sQ0FBQ2tCLEtBQVI7QUFDQSxVQUFNQyxNQUFnQixHQUFHLEVBQXpCO0FBQ0F4QixNQUFBQSxJQUFJLENBQUN5QixNQUFMLEdBQWMsQ0FBZCxJQUFtQnpCLElBQUksQ0FBQzBCLEdBQUwsQ0FBUyxVQUFDQyxJQUFELEVBQWU7QUFDekNILFFBQUFBLE1BQU0sQ0FBQ0ksSUFBUCxDQUFZRCxJQUFJLENBQUNFLElBQWpCO0FBQ0QsT0FGa0IsQ0FBbkI7O0FBR0EsVUFBTUMsT0FBOEIsbUNBQU87QUFDekNDLFFBQUFBLE1BQU0sRUFBRSxJQURpQztBQUV6Q0MsUUFBQUEsSUFBSSxFQUFFLFFBRm1DO0FBR3pDQyxRQUFBQSxJQUFJLEVBQUUsUUFIbUM7QUFJekNDLFFBQUFBLElBQUksRUFBRTtBQUptQyxPQUFQLEdBSzlCbkMsTUFMOEIsQ0FBcEM7O0FBTUFNLE1BQUFBLE9BQU8sQ0FBQzhCLFNBQVIsQ0FBa0I7QUFDaEJDLFFBQUFBLE9BQU8sRUFBRTtBQUNQQyxVQUFBQSxPQUFPLEVBQUUsTUFERjtBQUVQQyxVQUFBQSxrQkFBa0IsRUFBRTtBQUZiLFNBRE87QUFLaEJ2QyxRQUFBQSxNQUFNLEVBQUUrQixPQUxRO0FBTWhCUyxRQUFBQSxLQUFLLEVBQUUzQyxNQU5TO0FBT2hCRSxRQUFBQSxNQUFNLEVBQUUsQ0FDTjtBQUNFRSxVQUFBQSxJQUFJLEVBQUVBLElBRFI7QUFFRXdDLFVBQUFBLElBQUksRUFBRSxLQUZSO0FBR0VDLFVBQUFBLE1BQU0sRUFBRTNDLE1BQU0sQ0FBQzJDLE1BQVAsR0FBZ0IzQyxNQUFNLENBQUMyQyxNQUF2QixHQUFnQyxLQUgxQztBQUlFQyxVQUFBQSxNQUFNLEVBQUU1QyxNQUFNLENBQUM0QyxNQUFQLEdBQWdCNUMsTUFBTSxDQUFDNEMsTUFBdkIsR0FBZ0MsQ0FBQyxLQUFELEVBQVEsS0FBUixDQUoxQztBQUtFN0MsVUFBQUEsS0FBSyxFQUFFO0FBQ0xxQyxZQUFBQSxJQUFJLEVBQUVyQyxLQUFLLENBQUNxQyxJQURQO0FBRUxTLFlBQUFBLE9BQU8sRUFBRTlDLEtBQUssQ0FBQytDLFlBQU4sR0FBcUIsTUFBckIsR0FBOEIsTUFGbEM7QUFHTEMsWUFBQUEsUUFBUSxFQUFFaEQsS0FBSyxDQUFDZ0QsUUFIWDtBQUlMRCxZQUFBQSxZQUFZLEVBQUUvQyxLQUFLLENBQUMrQyxZQUpmO0FBS0xFLFlBQUFBLFNBQVMsRUFBRWpELEtBQUssQ0FBQ2lELFNBQU4sR0FBa0JqRCxLQUFLLENBQUNpRCxTQUF4QixHQUFvQyxFQUwxQztBQU1MUCxZQUFBQSxLQUFLLEVBQUUxQyxLQUFLLENBQUMwQyxLQU5SO0FBT0xRLFlBQUFBLFVBQVUsRUFBRWxELEtBQUssQ0FBQ2tELFVBQU4sR0FBbUJsRCxLQUFLLENBQUNrRCxVQUF6QixHQUFzQyxFQVA3QztBQVFMQyxZQUFBQSxTQUFTLEVBQUVuRCxLQUFLLENBQUNtRCxTQUFOLEdBQWtCbkQsS0FBSyxDQUFDbUQsU0FBeEIsR0FBb0M7QUFSMUMsV0FMVDtBQWVFQyxVQUFBQSxTQUFTLEVBQUU7QUFDVHhCLFlBQUFBLE1BQU0sRUFBRTVCLEtBQUssQ0FBQzRCLE1BQU4sR0FBZTVCLEtBQUssQ0FBQzRCLE1BQXJCLEdBQThCLEVBRDdCO0FBRVR5QixZQUFBQSxPQUFPLEVBQUVyRCxLQUFLLENBQUNxRCxPQUFOLEdBQWdCckQsS0FBSyxDQUFDcUQsT0FBdEIsR0FBZ0M7QUFGaEM7QUFmYixTQURNO0FBUFEsT0FBbEIsRUE2QkcsSUE3Qkg7QUE4QkQ7QUFDRixHQTVDUSxFQTRDTixDQUFDN0MsT0FBRCxFQUFVTCxJQUFWLENBNUNNLENBQVQ7QUE4Q0FqQixFQUFBQSxTQUFTLENBQUMsWUFBTTtBQUNkLFFBQUlvRSxlQUFKOztBQUNBLFFBQUk5QyxPQUFPLElBQUlKLFFBQVgsSUFBdUIsQ0FBQ00sTUFBeEIsSUFBa0NQLElBQUksQ0FBQ3lCLE1BQUwsR0FBYyxDQUFwRCxFQUF1RDtBQUNyRDBCLE1BQUFBLGVBQWUsR0FBR0MsV0FBVyxDQUFDLFlBQU07QUFDbEMzQyxRQUFBQSxZQUFZLENBQUMsVUFBQTRDLENBQUMsRUFBSTtBQUNoQmhELFVBQUFBLE9BQU8sQ0FBQ2lELGNBQVIsQ0FBdUI7QUFDckJkLFlBQUFBLElBQUksRUFBRSxTQURlO0FBRXJCZSxZQUFBQSxXQUFXLEVBQUUsQ0FGUTtBQUdyQkMsWUFBQUEsU0FBUyxFQUFFSDtBQUhVLFdBQXZCOztBQUtBLGNBQUlBLENBQUMsSUFBSXJELElBQUksQ0FBQ3lCLE1BQUwsR0FBYyxDQUF2QixFQUEwQjtBQUN4QixtQkFBTyxDQUFQO0FBQ0QsV0FGRCxNQUVPO0FBQ0wsbUJBQU80QixDQUFDLEdBQUcsQ0FBWDtBQUNEO0FBQ0YsU0FYVyxDQUFaO0FBWUQsT0FiNEIsRUFhMUJuRCxVQWIwQixDQUE3QjtBQWNEOztBQUNELFdBQU8sWUFBTTtBQUNYdUQsTUFBQUEsYUFBYSxDQUFDTixlQUFELENBQWI7QUFDRCxLQUZEO0FBR0QsR0FyQlEsRUFxQk4sQ0FBQzlDLE9BQUQsRUFBVUosUUFBVixFQUFvQk0sTUFBcEIsRUFBNEJQLElBQTVCLENBckJNLENBQVQ7QUF1QkEsc0JBQ0U7QUFBSyxJQUFBLEdBQUcsRUFBRUksUUFBVjtBQUNFLElBQUEsS0FBSyxFQUFFO0FBQ0wsZUFBU1YsS0FESjtBQUVMLGdCQUFVQztBQUZMO0FBRFQsSUFERjtBQVFELENBbkhEOztBQXFIQSxlQUFlSCxVQUFmIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IHVzZUVmZmVjdCwgdXNlUmVmLCB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0JztcclxuXHJcbmltcG9ydCAqIGFzIGVjaGFydHMgZnJvbSAnZWNoYXJ0cy9jb3JlJztcclxuaW1wb3J0IHsgVG9vbHRpcENvbXBvbmVudCwgTGVnZW5kQ29tcG9uZW50LCBMZWdlbmRDb21wb25lbnRPcHRpb24gIH0gZnJvbSAnZWNoYXJ0cy9jb21wb25lbnRzJztcclxuaW1wb3J0IHsgUGllQ2hhcnQgfSBmcm9tICdlY2hhcnRzL2NoYXJ0cyc7XHJcbmltcG9ydCB7IENhbnZhc1JlbmRlcmVyIH0gZnJvbSAnZWNoYXJ0cy9yZW5kZXJlcnMnO1xyXG5cclxuZWNoYXJ0cy51c2UoXHJcbiAgW1Rvb2x0aXBDb21wb25lbnQsIExlZ2VuZENvbXBvbmVudCwgUGllQ2hhcnQsIENhbnZhc1JlbmRlcmVyXVxyXG4pO1xyXG5cclxuaW50ZXJmYWNlIExhYmVsUHJvcHMge1xyXG4gIHNob3c/OiBib29sZWFuO1xyXG4gIC8qKiDlrZfkvZPpopzoibIgKi9cclxuICBjb2xvcj86IHN0cmluZztcclxuICAvKiog5a2X5L2T5aSn5bCP77yM6buY6K6kMTTlg4/ntKAgKi9cclxuICBmb250U2l6ZT86IG51bWJlciB8IHN0cmluZztcclxuICAvKiogXHJcbiAgICog5qCH562+5YaF5a655qC85byPXHJcbiAgICogQHthfe+8muezu+WIl+WQjeOAglxyXG4gICAqIEB7Yn3vvJrmlbDmja7lkI3jgIJcclxuICAgKiBAe2N977ya5pWw5o2u5YC844CCXHJcbiAgICogQHtkfe+8mueZvuWIhuavlOOAglxyXG4gICAqL1xyXG4gIGZvcm1hdHRlcj86IHN0cmluZyB8IEZ1bmN0aW9uO1xyXG4gIGVkZ2VEaXN0YW5jZT86IG51bWJlciB8IHN0cmluZztcclxuICAvKiog6KGM6auYICovXHJcbiAgbGluZUhlaWdodD86IG51bWJlcjtcclxuICAvKiog56ys5LiA5q615byV5a+857q/6ZW/5bqmICovXHJcbiAgbGVuZ3RoPzogbnVtYmVyO1xyXG4gIC8qKiDnrKzkuozmrrXlvJXlr7znur/plb/luqYgKi9cclxuICBsZW5ndGgyPzogbnVtYmVyO1xyXG4gIC8qKiDmoIfnrb7kuYvpl7Tpl7Tot53vvIzpu5jorqQxMOWDj+e0oCAqL1xyXG4gIG1pbk1hcmdpbj86IG51bWJlcjtcclxufVxyXG5cclxuaW50ZXJmYWNlIFNlcmllc1Byb3BzIHtcclxuICBjZW50ZXI/OiBzdHJpbmdbXSB8IG51bWJlciB8IHN0cmluZztcclxuICByYWRpdXM/OiBzdHJpbmdbXSB8IG51bWJlcltdIHwgbnVtYmVyIHwgc3RyaW5nO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgUGllQmFzZVByb3BzIHtcclxuICBkYXRhPzogYW55W107XHJcbiAgd2lkdGg/OiBzdHJpbmc7XHJcbiAgaGVpZ2h0Pzogc3RyaW5nO1xyXG4gIC8qKiDppbzlm77popzoibIgKi9cclxuICBjb2xvcnM/OiBzdHJpbmdbXTtcclxuICBsYWJlbD86IExhYmVsUHJvcHM7XHJcbiAgLyoqIOmlvOWbvuWxnuaApyAqL1xyXG4gIHNlcmllcz86IFNlcmllc1Byb3BzO1xyXG4gIC8qKiDlm77kvovnu4Tku7YsIGFwaTogaHR0cHM6Ly9lY2hhcnRzLmFwYWNoZS5vcmcvemgvb3B0aW9uLmh0bWwjbGVnZW5kICovXHJcbiAgbGVnZW5kPzogTGVnZW5kQ29tcG9uZW50T3B0aW9uO1xyXG4gIC8qKiDmmK/lkKboh6rliqjliIfmjaIgVG9vbHRpcCAqL1xyXG4gIGlzU3dpdGNoPzogYm9vbGVhbjtcclxuICAvKiog6Ieq5Yqo5YiH5o2i5LqL5Lu2IOm7mOiupCAyMDAw77yIMlPvvIkgKi9cclxuICBzd2l0Y2hUaW1lPzogbnVtYmVyO1xyXG4gIG9uQ2xpY2s/OiAodjogYW55KSA9PiB2b2lkO1xyXG59XHJcblxyXG5jb25zdCBFQ2hhcnRzUGllID0gKHByb3BzOiBQaWVCYXNlUHJvcHMpID0+IHtcclxuICBjb25zdCB7XHJcbiAgICB3aWR0aCA9ICcxMDAlJyxcclxuICAgIGhlaWdodCA9ICcxMDAlJyxcclxuICAgIGNvbG9ycyA9IFsnIzU0NzBjNicsICcjOTFjYzc1JywgJyNmYWM4NTgnLCAnI2VlNjY2NicsICcjNzNjMGRlJywgJyMzYmEyNzInLCAnI2ZjODQ1MicsICcjOWE2MGI0JywgJyNlYTdjY2MnXSxcclxuICAgIGxhYmVsID0ge30sXHJcbiAgICBzZXJpZXMgPSB7fSxcclxuICAgIGxlZ2VuZCA9IHt9LFxyXG4gICAgZGF0YSA9IFtdLFxyXG4gICAgaXNTd2l0Y2ggPSBmYWxzZSxcclxuICAgIHN3aXRjaFRpbWUgPSAyMDAwLFxyXG4gICAgb25DbGlja1xyXG4gIH0gPSBwcm9wcztcclxuXHJcbiAgY29uc3QgY2hhcnRSZWYgPSB1c2VSZWY8YW55PihudWxsKVxyXG4gIGNvbnN0IFtteUNoYXJ0LCBzZXRNeUNoYXJ0XSA9IHVzZVN0YXRlPGFueT4obnVsbCk7XHJcbiAgY29uc3QgW2lzSGlnaF0gPSB1c2VTdGF0ZTxib29sZWFuPihmYWxzZSk7XHJcbiAgY29uc3QgW2hpZ2hJbmRleCwgc2V0SGlnaEluZGV4XSA9IHVzZVN0YXRlPG51bWJlcj4oMCk7XHJcbiAgXHJcblxyXG4gIHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICBsZXQgX215Q2hhcnQ6IGFueSA9IGVjaGFydHMuaW5pdChjaGFydFJlZi5jdXJyZW50KTtcclxuICAgIHNldE15Q2hhcnQoX215Q2hhcnQpXHJcblxyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgX215Q2hhcnQucmVzaXplLCBmYWxzZSk7XHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIF9teUNoYXJ0LnJlc2l6ZSwgZmFsc2UpO1xyXG4gICAgX215Q2hhcnQub2ZmKCdjbGljaycpO1xyXG4gICAgX215Q2hhcnQub24oJ2NsaWNrJywgKHY6IGFueSkgPT4ge1xyXG4gICAgICBvbkNsaWNrPy4odi5kYXRhKTtcclxuICAgICAgY29uc29sZS5sb2codi5kYXRhKVxyXG4gICAgfSlcclxuICAgIHJldHVybiAoKSA9PiB7XHJcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdyZXNpemUnLCBfbXlDaGFydC5yZXNpemUsIGZhbHNlKTtcclxuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBfbXlDaGFydC5yZXNpemUsIGZhbHNlKTtcclxuICAgICAgX215Q2hhcnQuZGlzcG9zZSgpO1xyXG4gICAgfVxyXG4gIH0sIFtdKVxyXG5cclxuICB1c2VFZmZlY3QoKCkgPT4ge1xyXG4gICAgaWYgKG15Q2hhcnQpIHtcclxuICAgICAgbXlDaGFydC5jbGVhcigpO1xyXG4gICAgICBjb25zdCBfbmFtZXM6IHN0cmluZ1tdID0gW107XHJcbiAgICAgIGRhdGEubGVuZ3RoID4gMCAmJiBkYXRhLm1hcCgoaXRlbTogYW55KSA9PiB7XHJcbiAgICAgICAgX25hbWVzLnB1c2goaXRlbS5uYW1lKTtcclxuICAgICAgfSlcclxuICAgICAgY29uc3QgX2xlZ2VuZDogTGVnZW5kQ29tcG9uZW50T3B0aW9uID0gey4uLntcclxuICAgICAgICBib3R0b206ICc1JScsXHJcbiAgICAgICAgbGVmdDogJ2NlbnRlcicsXHJcbiAgICAgICAgaWNvbjogJ2NpcmNsZScsXHJcbiAgICAgICAgc2hvdzogdHJ1ZVxyXG4gICAgICB9LCAuLi5sZWdlbmR9O1xyXG4gICAgICBteUNoYXJ0LnNldE9wdGlvbih7XHJcbiAgICAgICAgdG9vbHRpcDoge1xyXG4gICAgICAgICAgdHJpZ2dlcjogJ2l0ZW0nLFxyXG4gICAgICAgICAgdHJhbnNpdGlvbkR1cmF0aW9uOiAwLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgbGVnZW5kOiBfbGVnZW5kLFxyXG4gICAgICAgIGNvbG9yOiBjb2xvcnMsXHJcbiAgICAgICAgc2VyaWVzOiBbXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIGRhdGE6IGRhdGEsXHJcbiAgICAgICAgICAgIHR5cGU6ICdwaWUnLFxyXG4gICAgICAgICAgICByYWRpdXM6IHNlcmllcy5yYWRpdXMgPyBzZXJpZXMucmFkaXVzIDogJzcwJScsXHJcbiAgICAgICAgICAgIGNlbnRlcjogc2VyaWVzLmNlbnRlciA/IHNlcmllcy5jZW50ZXIgOiBbJzUwJScsICc1MCUnXSxcclxuICAgICAgICAgICAgbGFiZWw6IHtcclxuICAgICAgICAgICAgICBzaG93OiBsYWJlbC5zaG93LFxyXG4gICAgICAgICAgICAgIGFsaWduVG86IGxhYmVsLmVkZ2VEaXN0YW5jZSA/ICdlZGdlJyA6ICdub25lJyxcclxuICAgICAgICAgICAgICBmb250U2l6ZTogbGFiZWwuZm9udFNpemUsXHJcbiAgICAgICAgICAgICAgZWRnZURpc3RhbmNlOiBsYWJlbC5lZGdlRGlzdGFuY2UsXHJcbiAgICAgICAgICAgICAgbWluTWFyZ2luOiBsYWJlbC5taW5NYXJnaW4gPyBsYWJlbC5taW5NYXJnaW4gOiAxMCxcclxuICAgICAgICAgICAgICBjb2xvcjogbGFiZWwuY29sb3IsXHJcbiAgICAgICAgICAgICAgbGluZUhlaWdodDogbGFiZWwubGluZUhlaWdodCA/IGxhYmVsLmxpbmVIZWlnaHQgOiAyMCxcclxuICAgICAgICAgICAgICBmb3JtYXR0ZXI6IGxhYmVsLmZvcm1hdHRlciA/IGxhYmVsLmZvcm1hdHRlciA6IGZhbHNlXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGxhYmVsTGluZToge1xyXG4gICAgICAgICAgICAgIGxlbmd0aDogbGFiZWwubGVuZ3RoID8gbGFiZWwubGVuZ3RoIDogMTAsXHJcbiAgICAgICAgICAgICAgbGVuZ3RoMjogbGFiZWwubGVuZ3RoMiA/IGxhYmVsLmxlbmd0aDIgOiAyMCxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIF1cclxuICAgICAgfSwgdHJ1ZSk7XHJcbiAgICB9XHJcbiAgfSwgW215Q2hhcnQsIGRhdGFdKVxyXG4gIFxyXG4gIHVzZUVmZmVjdCgoKSA9PiB7XHJcbiAgICBsZXQgZmF1bHRCeUhvdXJUaW1lOiBhbnk7XHJcbiAgICBpZiAobXlDaGFydCAmJiBpc1N3aXRjaCAmJiAhaXNIaWdoICYmIGRhdGEubGVuZ3RoID4gMCkge1xyXG4gICAgICBmYXVsdEJ5SG91clRpbWUgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcbiAgICAgICAgc2V0SGlnaEluZGV4KG4gPT4ge1xyXG4gICAgICAgICAgbXlDaGFydC5kaXNwYXRjaEFjdGlvbih7XHJcbiAgICAgICAgICAgIHR5cGU6ICdzaG93VGlwJyxcclxuICAgICAgICAgICAgc2VyaWVzSW5kZXg6IDAsXHJcbiAgICAgICAgICAgIGRhdGFJbmRleDogblxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBpZiAobiA+PSBkYXRhLmxlbmd0aCAtIDEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gbiArIDFcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICB9LCBzd2l0Y2hUaW1lKVxyXG4gICAgfVxyXG4gICAgcmV0dXJuICgpID0+IHtcclxuICAgICAgY2xlYXJJbnRlcnZhbChmYXVsdEJ5SG91clRpbWUpXHJcbiAgICB9XHJcbiAgfSwgW215Q2hhcnQsIGlzU3dpdGNoLCBpc0hpZ2gsIGRhdGFdKVxyXG5cclxuICByZXR1cm4gKFxyXG4gICAgPGRpdiByZWY9e2NoYXJ0UmVmfVxyXG4gICAgICBzdHlsZT17e1xyXG4gICAgICAgICd3aWR0aCc6IHdpZHRoLFxyXG4gICAgICAgICdoZWlnaHQnOiBoZWlnaHRcclxuICAgICAgfX0+XHJcbiAgICA8L2Rpdj5cclxuICApXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEVDaGFydHNQaWU7Il19